<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	template="/WEB-INF/templates/SbAdmin2/templateTeste.xhtml">

	<f:metadata>
		<o:viewParam name="cliente" value="#{clienteViewBean.cliente}"
			converter="#{clienteConverter}" />
		<f:event listener="#{clienteViewBean.preRenderView()}"
			type="preRenderView" />

		<o:viewParam name="compra" value="#{compraEdit.compra}"
			converter="#{compraConverter}" />
		<f:event listener="#{compraEdit.preRenderView()}" type="preRenderView" />
	</f:metadata>

	<ui:define name="titulo">Detalhes Cliente</ui:define>
	<ui:define name="content-header">Detalhes Cliente <small>Visualizar
			informações do cliente</small>
	</ui:define>
	<ui:define name="breadcrumb-header">
		<li><i class="fa fa-dashboard"></i> <a href="Home.xhtml">Dashboard</a>
		</li>
		<li><a href="Clientes.xhtml">Clientes</a></li>
		<li class="active">Detalhes Cliente</li>
	</ui:define>


	<ui:define name="conteudo">

		<h:form id="detailForm">
			<ui:include src="/WEB-INF/templates/_dialogConfirmation.xhtml" />

			<p:messages id="messages" autoUpdate="true" closable="true"
				showDetail="true" />

			<h:panelGrid columns="3">

				<p:button value="editar" id="btEdit" outcome="/ClienteEdit.xhtml"
					icon="fa fa-pencil"
					styleClass="btnn btnn-primary btnn-shadow btnn-rc">
					<f:param name="cliente" value="#{clienteViewBean.cliente.id}" />
				</p:button>

				<p:commandButton value="Remover" id="btRemove"
					action="#{clienteBean.remove}" icon="fa fa-trash"
					styleClass="btnn btnn-danger btnn-shadow btnn-rc">
					<f:setPropertyActionListener value="#{clienteViewBean.cliente}"
						target="#{clienteBean.selectedCliente}" />
					<p:confirm header="Remoção de cliente"
						message="Deseja remover este cliente?" />
				</p:commandButton>

				<p:button value="voltar" id="btvoltar" outcome="/Clientes.xhtml"
					icon="fa fa-reply"
					styleClass="btnn btnn-default btnn-shadow btnn-rc" />


			</h:panelGrid>

			<p:fieldset id="infor_detail" style="margin-top:10px;"
				styleClass="box box-success">
				<h2 class="page-header">
					<p:outputLabel value="#{clienteViewBean.cliente.nome}"
						styleClass="text-detail" />
				</h2>

				<p:outputPanel class="panel panel-default">

					<p:outputPanel class="panel-heading">
						<h3 class="panel-title">Informações gerais</h3>
					</p:outputPanel>

					<p:outputPanel class="panel-body">

						<p:outputPanel class="form-group row">

							<p:outputPanel class="col-sm-4">
								<h:outputText value="Nome: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.nome}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-4">
								<h:outputText value="CPF: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.cpf}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-4">
								<h:outputText value="Sexo: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.sexo}" />
							</p:outputPanel>

						</p:outputPanel>

						<p:outputPanel class="form-group row">

							<c:if test="${clienteViewBean.cliente.telefone != null}">
								<p:outputPanel class="col-sm-4">
									<h:outputText
										rendered="#{clienteViewBean.cliente.telefone == '' ? false : true}"
										value="Telefone: " style="font-weight: bold" />
									<h:outputText
										rendered="#{clienteViewBean.cliente.telefone == '' ? false : true}"
										value="#{clienteViewBean.cliente.telefone}" />
								</p:outputPanel>								
							</c:if>
							
							<p:outputPanel class="col-sm-4">
								<h:outputText value="Celular: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.celular}" />
							</p:outputPanel>

							<c:if test="${clienteViewBean.cliente.email != null}">
								<p:outputPanel class="col-sm-4">
									<h:outputText
										rendered="#{clienteViewBean.cliente.email == '' ? false : true}"
										value="Email: " style="font-weight: bold" />
									<h:outputText
										rendered="#{clienteViewBean.cliente.email == '' ? false : true}"
										value="#{clienteViewBean.cliente.email}" />
								</p:outputPanel>
							</c:if>
							
						</p:outputPanel>

					</p:outputPanel>

				</p:outputPanel>

				<p:outputPanel class="panel panel-default">

					<p:outputPanel class="panel-heading">
						<h3 class="panel-title">Informações de endereço</h3>
					</p:outputPanel>

					<p:outputPanel class="panel-body">

						<p:outputPanel class="form-group row">

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Endereço: " style="font-weight: bold" />
								<h:outputText
									value="#{clienteViewBean.cliente.endereco.logradouro}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Número: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.numero}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Zona: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.zona}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Bairro: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.bairro}" />
							</p:outputPanel>

						</p:outputPanel>

						<p:outputPanel class="form-group row">

							<c:if test="${clienteViewBean.cliente.endereco.complemento != null}">
								<p:outputPanel class="col-sm-3">
									<h:outputText
										rendered="#{clienteViewBean.cliente.endereco.complemento.trim() == '' ? false : true}"
										value="Complemento: " style="font-weight: bold" />
									<h:outputText
										rendered="#{clienteViewBean.cliente.endereco.complemento.trim() == '' ? false : true}"
										value="#{clienteViewBean.cliente.endereco.complemento}" />
								</p:outputPanel>
							</c:if>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="CEP: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.cep}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Cidade: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.cidade}" />
							</p:outputPanel>

							<p:outputPanel class="col-sm-3">
								<h:outputText value="Estado: " style="font-weight: bold" />
								<h:outputText value="#{clienteViewBean.cliente.endereco.estado}" />
							</p:outputPanel>
						</p:outputPanel>
					</p:outputPanel>
				</p:outputPanel>

				<p:outputPanel class="panel panel-default">
					<p:outputPanel class="panel-heading">
						<h3 class="panel-title">Compras</h3>
					</p:outputPanel>

					<p:outputPanel class="table-responsive">
						<p:dataTable id="tableCompras" var="compra"
							value="#{compraBean.getComprasByCliente(cliente)}" paginatorPosition="bottom"
							rows="15" paginator="true" paginatorAlwaysVisible="false"
							widgetVar="findCompra" reflow="true"
							emptyMessage="Nenhuma compra registrada" rowKey="#{compra.id}"
							styleClass="ui-datatable" selectionMode="single"
							selection="#{compraBean.selectedCompra}">

							<f:facet name="header">
								<p:outputPanel align="left">
									<p:inputText id="globalFilter"
										onkeyup="PF('findCompra').filter()" style="width:300px;"
										placeholder="Buscar compras" />
								</p:outputPanel>
							</f:facet>

							<p:ajax event="rowSelect" listener="#{compraBean.renderTo}">
								<f:setPropertyActionListener value="#{compra}"
									target="#{pecaViewBean.peca}" />
							</p:ajax>

							<p:column headerText="#" width="2%" filterBy="#{compra.id}"
								filterStyle="display:none;">
								<h:outputText id="id" value="#{compra.id}" />
							</p:column>

							<p:column headerText="Data" width="4%" filterBy="#{compra.data}"
								filterStyle="display:none;">
								<h:outputText id="data" value="#{compra.data}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</p:column>

							<p:column headerText="Quantidade" width="3%">
								<h:outputText id="quant"
									value="#{compraBean.getQuantidade(compra)}" />
							</p:column>

							<p:column headerText="Peças" width="3%">
								<h:outputText id="pecas" value="#{compraBean.getPecas(compra)}" />
							</p:column>

							<p:column headerText="Valor" width="3%">
								<h:outputText id="valor" value="#{compraBean.getValor(compra)}" />
							</p:column>
							
							<p:column width="1.4%">
								<p:commandButton value="Pagar" type="button"
									onclick="PF('dlg2').show();" />
							</p:column>
							
						</p:dataTable>
					</p:outputPanel>
				</p:outputPanel>

				<p:dialog header="Modal Dialog" widgetVar="dlg2" modal="true"
					height="500" width="500">
					
					<p:outputLabel for="payment" value="Forma de pagamento: " />

					<p:selectOneMenu id="payment" required="true" requiredMessage="O campo forma de pagamento é obrigatório!"
						>

						<f:selectItem itemLabel="Selecione uma forma de pagamento"
							noSelectionOption="true" />
						<f:selectItems value="#{compraEdit.payments}"
							itemValue="#{payment}" itemLabel="#{payment.tipoDePagamento}"
							var="payment" />
					</p:selectOneMenu>
				
				</p:dialog>

			</p:fieldset>
		</h:form>
	</ui:define>
</ui:composition>